HOST_IP: 10.8.32.99
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 4 --seq_length 1024 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro
Running on device: cuda:4 is_deepspeed: False
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:1 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.14it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.12it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.28it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.96it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.28it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:05,  5.56it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.03it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.98it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.56it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.19it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.80it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.17it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.89it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.79it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:04,  6.27it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.78it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.53it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.11it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.52it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.21it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.09it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.91it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:04,  6.53it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.69it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.70it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.27it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.37it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.25it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.74it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.79it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  6.66it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.80it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.36it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.45it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.86it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.33it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.85it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.86it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.42it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  6.74it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.51it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.95it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.39it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.90it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.90it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.45it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  9.02it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.55it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.42it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  6.79it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.93it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.93it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.48it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  9.06it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.57it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.44it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.94it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:01<00:03,  6.82it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.95it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.49it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  9.10it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.59it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.95it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.24it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.96it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:03,  6.84it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:01,  9.12it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.28it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.37it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.74it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.31it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.95it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.14it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:03,  6.85it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.35it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.44it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:01<00:43,  1.50s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.79it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.37it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.78it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  9.15it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.41it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.50it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.85it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  6.86it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.41it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.86it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  9.15it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.44it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.89it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.54it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.44it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.92it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  6.87it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  9.16it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.47it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.93it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.45it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.96it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  9.17it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  6.87it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.49it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.96it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.60it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.98it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.47it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  9.17it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  6.88it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.98it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.50it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.61it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  9.00it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.48it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.18it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.99it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.51it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.63it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:02<00:02,  6.88it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  9.01it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.18it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.49it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.00it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.52it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.63it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.02it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.18it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.49it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:02<00:02,  6.63it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.00it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.52it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.64it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.01it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.18it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.49it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.98it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:02,  6.76it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.52it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.63it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.00it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.18it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.50it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.90it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  6.85it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.53it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.02it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.63it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.18it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.51it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.87it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.17it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.53it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.63it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  6.92it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.51it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.86it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.05it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.17it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.63it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.53it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.51it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  6.97it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.86it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:02<00:00,  9.17it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.06it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.63it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.53it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:42,  1.53s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.50it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  7.01it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.84it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.16it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.06it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.63it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.53it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.51it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.85it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.17it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.07it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:03<00:01,  7.04it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.63it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.53it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.51it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.84it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.20it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.05it/s]
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.07it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.63it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:03<00:01,  7.06it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.54it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.51it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.86it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.09it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.62it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.53it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:00,  7.07it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.52it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.91it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.85it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.13it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.94it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.53it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  7.09it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.52it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.54it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.56it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.44it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.55it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.42it/s]
Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  7.11it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  7.11it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  7.13it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:04<00:00,  7.13it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:04<00:00,  7.15it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  7.18it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  6.92it/s]
Loading checkpoint shards:  10%|█         | 3/30 [00:04<00:42,  1.56s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  13%|█▎        | 4/30 [00:06<00:40,  1.57s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:07<00:38,  1.55s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  20%|██        | 6/30 [00:09<00:36,  1.53s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:10<00:34,  1.52s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:12<00:33,  1.53s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:13<00:32,  1.53s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:15<00:30,  1.51s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:16<00:28,  1.49s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:18<00:26,  1.48s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:19<00:25,  1.50s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:21<00:24,  1.51s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:23<00:23,  1.59s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:25<00:27,  1.99s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:28<00:26,  2.02s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:30<00:25,  2.09s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:32<00:23,  2.12s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:34<00:20,  2.10s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:36<00:18,  2.11s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:39<00:17,  2.20s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:41<00:15,  2.24s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:43<00:13,  2.31s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:46<00:11,  2.38s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:49<00:09,  2.50s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:51<00:07,  2.53s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:54<00:05,  2.62s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [01:02<00:04,  4.28s/it]Loading checkpoint shards: 100%|██████████| 30/30 [01:05<00:00,  3.77s/it]Loading checkpoint shards: 100%|██████████| 30/30 [01:05<00:00,  2.18s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Epoch 1, Step 10, Loss: 0.2659473419189453 sync: True time: 13.712512969970703 alloc_mem: 37395346432 peak_mem: 49740805120
Epoch 1, Step 20, Loss: 0.13801993429660797 sync: True time: 13.70773959159851 alloc_mem: 37395346432 peak_mem: 49740805120
Epoch 1, Step 30, Loss: 0.1280665099620819 sync: True time: 13.715821981430054 alloc_mem: 37395346432 peak_mem: 49740805120
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=4 seq=1024 zero_stage=3 acc=1 ac=True compile=False schedule=False passes=None compile_time=0 iteration time: 13.4375 alloc_mem: 37395346432 peak_mem: 49740805120
[rank0]:[W1217 04:28:17.681191364 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
