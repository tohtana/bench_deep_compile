HOST_IP: 10.8.32.150
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 2 --seq_length 2048 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:7 is_deepspeed: False
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:1 is_deepspeed: False
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:4 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.44it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.29it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.86it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.53it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.90it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.08it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.43it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.57it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.61it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.04it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.65it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.75it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.32it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.93it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.33it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.90it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.72it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:04,  6.66it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.65it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.06it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.24it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.61it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.03it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.75it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.80it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.21it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  6.91it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.39it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.76it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.11it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.77it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.88it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.29it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.48it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.00it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  7.86it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.16it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.77it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.94it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.53it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.35it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  7.06it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.19it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  7.90it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.78it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.98it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.56it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.38it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.21it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  7.93it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.77it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  7.14it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  9.00it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.58it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.40it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.22it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.75it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  7.96it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  9.02it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:03,  7.20it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.59it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.42it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.74it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.23it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  9.02it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  7.96it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:03,  7.26it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.42it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.44it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.73it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  9.02it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.24it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  7.98it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  7.30it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.44it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.44it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.55it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.24it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  7.98it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.51it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.46it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  7.32it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.62it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.26it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.01it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.64it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.47it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  7.35it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  9.01it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.74it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.27it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.02it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.72it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.47it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:01<00:51,  1.77s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.83it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  7.37it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.17it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.74it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.03it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.48it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.80it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.80it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  7.53it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.01it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.70it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  7.84it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.21it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.87it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.79it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:02,  7.44it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.12it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.68it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:01,  7.91it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.31it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.93it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.78it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:02<00:01,  7.66it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.66it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.19it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.97it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.01it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.38it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.77it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:01,  7.80it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.65it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.24it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.00it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.43it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.02it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.74it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.64it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  7.92it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.28it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.01it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.45it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.74it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.08it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.63it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  7.99it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.29it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.01it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.47it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.74it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.14it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.62it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.02it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.05it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.31it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.75it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.50it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.20it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.61it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.33it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.11it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.75it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.52it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.24it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.05it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.62it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.35it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.15it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.54it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.27it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.05it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.62it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.36it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.16it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.54it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  8.29it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.06it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.37it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.81it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:00,  8.19it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.55it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.30it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.06it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.74it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.93it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.73it/s]
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.39it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  8.20it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.56it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.31it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.07it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:46,  1.64s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.76it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.38it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.57it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.22it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.31it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.10it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.96it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.70it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.38it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.57it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.26it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.31it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.67it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.58it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.41it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.23it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.58it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.42it/s]
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.26it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.32it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.28it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.37it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.06it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.30it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  7.74it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  10%|█         | 3/30 [00:04<00:43,  1.61s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:06<00:41,  1.61s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:08<00:39,  1.59s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  20%|██        | 6/30 [00:09<00:39,  1.63s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:11<00:35,  1.56s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:12<00:34,  1.55s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:14<00:32,  1.54s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:15<00:30,  1.50s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:17<00:28,  1.48s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:18<00:26,  1.47s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:20<00:25,  1.49s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:21<00:23,  1.50s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:23<00:22,  1.49s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:24<00:20,  1.48s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:25<00:19,  1.47s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:27<00:17,  1.49s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:28<00:16,  1.49s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:30<00:14,  1.47s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:31<00:13,  1.45s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:33<00:11,  1.44s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:35<00:11,  1.70s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:38<00:13,  2.22s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:42<00:12,  2.59s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:47<00:13,  3.26s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:52<00:11,  3.82s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:56<00:07,  3.88s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:59<00:03,  3.68s/it]Loading checkpoint shards: 100%|██████████| 30/30 [01:00<00:00,  3.00s/it]Loading checkpoint shards: 100%|██████████| 30/30 [01:00<00:00,  2.03s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank5]:W1216 14:56:01.541000 3380863 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank6]:W1216 14:56:01.542000 3380864 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank7]:W1216 14:56:01.542000 3380865 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1216 14:56:01.543000 3380862 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank3]:W1216 14:56:01.543000 3380861 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank1]:W1216 14:56:01.543000 3380859 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1216 14:56:01.578000 3380860 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1216 14:56:01.603000 3380858 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.08319263160228729 sync: True time: 14.430765390396118 alloc_mem: 37395346432 peak_mem: 49807897600
Epoch 1, Step 20, Loss: 0.055771343410015106 sync: True time: 14.402004957199097 alloc_mem: 37395346432 peak_mem: 49807897600
Epoch 1, Step 30, Loss: 0.06711987406015396 sync: True time: 14.418174982070923 alloc_mem: 37395346432 peak_mem: 49807897600
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=2 seq=2048 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 14.1147 alloc_mem: 37395346432 peak_mem: 49807897600
[rank0]:[W1216 15:03:54.354733789 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
