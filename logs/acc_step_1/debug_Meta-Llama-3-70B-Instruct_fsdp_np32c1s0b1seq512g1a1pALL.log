HOST_IP: 10.8.32.150
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 1 --seq_length 512 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:1 is_deepspeed: False
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Running on device: cuda:4 is_deepspeed: False
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:3 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.27it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.37it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.05it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.05it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.86it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.29it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.18it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.11it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.93it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.92it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.15it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.15it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.03it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.95it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.29it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:05,  5.41it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.25it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.32it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.49it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.34it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.27it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.50it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.40it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.41it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:04,  6.04it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.64it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.49it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.44it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.63it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.50it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.48it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.73it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.59it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:04,  6.33it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.54it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.75it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.57it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.54it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.71it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.63it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.84it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.60it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:04,  6.46it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.60it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.56it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.73it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.89it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.65it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.62it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  6.55it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.63it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.59it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.83it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.94it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.67it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.65it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.65it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.61it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.89it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  6.61it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.97it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.69it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.68it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.67it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.94it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.63it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.99it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.70it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.69it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:01<00:03,  6.65it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.98it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.45it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:01,  9.01it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.56it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.70it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:03,  6.68it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.99it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.64it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.51it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.61it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.70it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.00it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.56it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:03,  6.74it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.72it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.62it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  9.00it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:01<00:51,  1.78s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.59it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.79it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  6.78it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.51it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  9.01it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.64it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.80it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.77it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  6.76it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.64it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.64it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.87it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.75it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.61it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  6.75it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.91it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.65it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.64it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.73it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.64it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  9.02it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.95it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.65it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.63it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  6.74it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.74it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.65it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.02it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.98it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.61it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.73it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:02<00:02,  6.73it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.03it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.97it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.62it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.72it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.69it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:02<00:02,  6.73it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.99it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.61it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.72it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.70it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.02it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.00it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.66it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.53it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:02,  6.47it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.70it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.01it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.66it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.36it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  6.59it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.66it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.73it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.32it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.04it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  6.68it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.66it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.73it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.35it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.04it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.04it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  6.76it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.66it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.80it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.37it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.05it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.71it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.03it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.86it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:03<00:01,  6.85it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.03it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.39it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.72it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.03it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:46,  1.65s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.64it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.86it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.03it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.43it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.44it/s]
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.73it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:03<00:01,  6.88it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.07it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.89it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.82it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.86it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.90it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.73it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:03<00:01,  6.89it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.66it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.58it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.82it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.68it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.63it/s]
Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:01,  6.89it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  6.88it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  6.87it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  6.88it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:04<00:00,  6.88it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:04<00:00,  6.87it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:04<00:00,  6.83it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  6.88it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  6.72it/s]
Loading checkpoint shards:  10%|█         | 3/30 [00:04<00:43,  1.62s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  13%|█▎        | 4/30 [00:06<00:41,  1.61s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:08<00:39,  1.60s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  20%|██        | 6/30 [00:09<00:37,  1.57s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:11<00:35,  1.53s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:12<00:33,  1.53s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:14<00:32,  1.53s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:15<00:29,  1.50s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:16<00:28,  1.48s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:18<00:26,  1.48s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:19<00:25,  1.49s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:21<00:24,  1.50s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:22<00:22,  1.49s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:24<00:20,  1.49s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:25<00:19,  1.48s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:27<00:17,  1.50s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:28<00:16,  1.50s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:30<00:14,  1.48s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:31<00:13,  1.47s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:33<00:11,  1.46s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:34<00:10,  1.49s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:37<00:10,  1.83s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:40<00:10,  2.09s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:42<00:09,  2.26s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:45<00:07,  2.39s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:48<00:05,  2.52s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:51<00:02,  2.59s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:52<00:00,  2.19s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:52<00:00,  1.75s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank5]:W1216 19:52:31.747000 3451868 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1216 19:52:31.747000 3451865 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank3]:W1216 19:52:31.747000 3451866 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank7]:W1216 19:52:31.748000 3451870 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1216 19:52:31.748000 3451867 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank1]:W1216 19:52:31.749000 3451864 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank6]:W1216 19:52:31.751000 3451869 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1216 19:52:32.054000 3451863 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.4417317807674408 sync: True time: 4.6340978145599365 alloc_mem: 35556611072 peak_mem: 47910441984
Epoch 1, Step 20, Loss: 0.28176844120025635 sync: True time: 4.659552335739136 alloc_mem: 35556611072 peak_mem: 47910441984
Epoch 1, Step 30, Loss: 0.20515254139900208 sync: True time: 4.647439002990723 alloc_mem: 35556611072 peak_mem: 47910441984
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=1 seq=512 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 4.4588 alloc_mem: 35556611072 peak_mem: 47910441984
[rank0]:[W1216 19:55:22.941302759 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
