HOST_IP: 10.8.32.150
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 2 --seq_length 512 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:4 is_deepspeed: False
Running on device: cuda:1 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.31it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.21it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.07it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.06it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.33it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.31it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.40it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.23it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.35it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.54it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.20it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:05,  5.77it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.57it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.12it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.41it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.50it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.04it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.52it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.66it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:04,  6.36it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.47it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.22it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.53it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.69it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.30it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.71it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.63it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:04,  6.57it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.65it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.57it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.77it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.40it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.74it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.71it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.87it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.63it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.84it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  6.68it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.51it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.76it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.78it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.01it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.65it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.87it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.57it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  6.74it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.77it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.83it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.67it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.90it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.09it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.61it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.78it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.86it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  6.77it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.92it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.68it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.14it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.65it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.79it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.88it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:01<00:03,  6.79it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.93it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.69it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  8.17it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.47it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.80it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.77it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.93it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.70it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:03,  6.81it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.54it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.20it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.80it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.73it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.93it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.70it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.58it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.22it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.79it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:03,  6.82it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.80it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.94it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.70it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.61it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.78it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.23it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.84it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  6.83it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.94it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.74it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.70it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.85it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.25it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.88it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.79it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.84it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  6.87it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.81it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.94it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.90it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.25it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.78it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.90it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.88it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.99it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  6.89it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.93it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.26it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:02<00:58,  2.03s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.85it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.87it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.97it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.92it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  6.88it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.27it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.88it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.84it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.81it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.91it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.26it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.91it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.80it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:02<00:02,  6.58it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.78it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.86it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.26it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.93it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.77it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.75it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.83it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:02<00:02,  6.71it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.93it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.26it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.94it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.74it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.72it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.80it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:02,  6.80it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.95it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.72it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  7.94it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.70it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.92it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.95it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  6.87it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  7.88it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.70it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.93it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.60it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.95it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  6.92it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.00it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.71it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.92it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.62it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.95it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.70it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.08it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.69it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  6.95it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.92it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.95it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.69it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.69it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.93it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.14it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.68it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  6.97it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.96it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.51it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.93it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.69it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.70it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.19it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.97it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:03<00:01,  6.99it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.52it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.93it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.68it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.73it/s]
Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.22it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.97it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:03<00:01,  7.01it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.63it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.65it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.94it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.72it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.25it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.99it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.87it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.99it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.84it/s]
Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:00,  7.04it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.80it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.61it/s]
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.28it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  7.08it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.29it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:52,  1.86s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.29it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  7.07it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.32it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.13it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  7.06it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  7.07it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:04<00:00,  7.08it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:04<00:00,  7.07it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  7.07it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  6.89it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  10%|█         | 3/30 [00:05<00:49,  1.82s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:07<00:47,  1.82s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:09<00:45,  1.83s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:11<00:43,  1.82s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:12<00:40,  1.77s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:14<00:38,  1.75s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:16<00:36,  1.73s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:17<00:33,  1.69s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:19<00:31,  1.66s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:20<00:29,  1.65s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:22<00:28,  1.67s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:24<00:26,  1.68s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:25<00:25,  1.67s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:27<00:23,  1.66s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:29<00:21,  1.64s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:30<00:19,  1.66s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:32<00:18,  1.66s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:34<00:16,  1.64s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:35<00:14,  1.62s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:37<00:12,  1.61s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:39<00:11,  1.65s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:40<00:09,  1.66s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:43<00:10,  2.01s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:46<00:08,  2.24s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:49<00:07,  2.39s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:52<00:05,  2.55s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:54<00:02,  2.65s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:56<00:00,  2.31s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:56<00:00,  1.88s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank3]:W1216 12:25:55.101000 3336970 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank6]:W1216 12:25:55.103000 3336973 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1216 12:25:55.105000 3336969 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank1]:W1216 12:25:55.105000 3336968 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1216 12:25:55.107000 3336971 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank5]:W1216 12:25:55.108000 3336972 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank7]:W1216 12:25:55.110000 3336974 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1216 12:25:55.162000 3336967 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.26888418197631836 sync: True time: 5.919559001922607 alloc_mem: 35819287552 peak_mem: 48181507072
Epoch 1, Step 20, Loss: 0.18745771050453186 sync: True time: 5.952198266983032 alloc_mem: 35819287552 peak_mem: 48181507072
Epoch 1, Step 30, Loss: 0.23610922694206238 sync: True time: 5.933788537979126 alloc_mem: 35819287552 peak_mem: 48181507072
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=2 seq=512 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 5.7144 alloc_mem: 35819287552 peak_mem: 48181507072
[rank0]:[W1216 12:29:26.777942162 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
