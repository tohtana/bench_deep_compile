HOST_IP: 10.8.32.99
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 4 --seq_length 1024 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Running on device: cuda:1 is_deepspeed: False
Running on device: cuda:4 is_deepspeed: False
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.86it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.67it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.42it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.60it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.95it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.96it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.32it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.40it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:05,  5.47it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.11it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.77it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.38it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.86it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.67it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.28it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.95it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.06it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.67it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.05it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:04,  6.18it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.84it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.69it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.26it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.22it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.24it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.84it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.93it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:04,  6.49it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.92it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.42it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.37it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.08it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  7.96it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.99it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  6.64it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:01<00:49,  1.71s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.06it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.52it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.46it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  9.03it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.17it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.02it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.14it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.58it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  6.73it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.53it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  9.05it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.22it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.05it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.19it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.60it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  9.06it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.56it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  6.79it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.27it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  8.07it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.63it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  8.23it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  9.07it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.59it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.29it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:01<00:03,  6.83it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.11it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.65it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.25it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  9.09it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.61it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.31it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.12it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:03,  6.85it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.65it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:01,  9.09it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.27it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.32it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.12it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.10it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.65it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:03,  6.87it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.28it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.64it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.33it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.13it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.98it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.66it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.65it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.29it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  6.88it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.33it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.15it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.90it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.45it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.64it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.29it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  6.89it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.34it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.16it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.98it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.52it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.65it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.30it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.35it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  6.90it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  9.04it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  7.99it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.65it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.31it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.36it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  9.09it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.14it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  6.91it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.61it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.66it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.31it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.37it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.12it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.24it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.66it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:02<00:02,  6.91it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.03it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.15it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.37it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.64it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.31it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.66it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.16it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:02<00:02,  6.77it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.00it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.41it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.65it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.37it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.66it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.18it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.11it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.46it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:02,  6.69it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.43it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.66it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.18it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.18it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.50it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.68it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.47it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:50,  1.82s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  6.80it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.67it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.19it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.23it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.49it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.69it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.50it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.67it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.20it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  6.87it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.27it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.45it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.69it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.52it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.67it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.20it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  6.92it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.29it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.42it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.69it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.55it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:02<00:00,  9.20it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.31it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  6.96it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.40it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.69it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.57it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.65it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.21it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.32it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.40it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.69it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:03<00:01,  6.99it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.59it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.21it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.66it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.39it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.70it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.26it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.06it/s]
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.59it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.69it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.52it/s]
Loading checkpoint shards:  73%|███████▎  | 22/30 [00:03<00:01,  7.02it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.39it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.70it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:00,  7.03it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.70it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.38it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.62it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  7.04it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.72it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.60it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.42it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.32it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.32it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.26it/s]
Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  7.04it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.34it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.19it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  7.04it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  7.04it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:04<00:00,  7.03it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:04<00:00,  7.03it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  7.05it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  6.88it/s]
Loading checkpoint shards:  10%|█         | 3/30 [00:05<00:49,  1.84s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  13%|█▎        | 4/30 [00:07<00:47,  1.84s/it]Using the latest cached version of the dataset since ag_news couldn't be found on the Hugging Face Hub
Found the latest cached dataset configuration 'default' at /home/aiscuser/.cache/huggingface/datasets/ag_news/default/0.0.0/eb185aade064a813bc0b7f42de02595523103ca4 (last modified on Tue Dec 17 04:11:14 2024).
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:09<00:45,  1.82s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  20%|██        | 6/30 [00:10<00:43,  1.80s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:12<00:40,  1.78s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:14<00:39,  1.78s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:16<00:37,  1.78s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:17<00:35,  1.75s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:19<00:32,  1.73s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:21<00:30,  1.72s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:23<00:29,  1.74s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:24<00:28,  1.76s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:26<00:26,  1.77s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:28<00:24,  1.76s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:30<00:22,  1.76s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:31<00:21,  1.78s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:33<00:19,  1.79s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:35<00:17,  1.78s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:37<00:15,  1.76s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:38<00:13,  1.75s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:40<00:12,  1.77s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:42<00:10,  1.78s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:44<00:08,  1.74s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:46<00:07,  1.77s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:47<00:05,  1.76s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:50<00:04,  2.08s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:53<00:02,  2.33s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:54<00:00,  2.04s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:54<00:00,  1.83s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank5]:W1217 04:30:26.744000 105745 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1217 04:30:26.745000 105742 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank6]:W1217 04:30:26.745000 105746 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank1]:W1217 04:30:26.746000 105741 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank7]:W1217 04:30:26.746000 105747 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1217 04:30:26.748000 105744 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank3]:W1217 04:30:26.748000 105743 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1217 04:30:26.799000 105740 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.26587867736816406 sync: True time: 13.761580228805542 alloc_mem: 37395346432 peak_mem: 49807897600
Epoch 1, Step 20, Loss: 0.13832803070545197 sync: True time: 13.75601577758789 alloc_mem: 37395346432 peak_mem: 49807897600
Epoch 1, Step 30, Loss: 0.12814168632030487 sync: True time: 13.773984909057617 alloc_mem: 37395346432 peak_mem: 49807897600
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=4 seq=1024 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 13.4666 alloc_mem: 37395346432 peak_mem: 49807897600
[rank0]:[W1217 04:38:00.180264985 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
