HOST_IP: 10.8.32.150
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 1 --seq_length 1024 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Running on device: cuda:4 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:1 is_deepspeed: False
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.16it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.22it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.80it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.34it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.12it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.34it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.02it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.08it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:05,  5.53it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.87it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.25it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.26it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.97it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.34it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.39it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.29it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.61it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.60it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.29it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:04,  6.24it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.50it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.56it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.50it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.77it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.77it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.45it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:04,  6.52it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.60it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.76it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.73it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.87it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.87it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.54it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.66it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  6.68it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.87it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.84it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.92it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.92it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.59it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.69it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:01<00:57,  1.99s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.93it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.91it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.97it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  6.75it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.92it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.64it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.71it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.89it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.86it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.99it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.88it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.67it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  6.77it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.73it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.88it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  9.01it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.84it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.85it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.69it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.58it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:01<00:03,  6.79it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  9.03it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.83it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.63it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.81it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.70it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.58it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.83it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.81it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.68it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:03,  6.80it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.80it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.71it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.64it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.87it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.80it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.73it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.57it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:03,  6.80it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.72it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.68it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.92it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.79it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.77it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.74it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  6.81it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.72it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.97it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.78it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.80it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.68it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.75it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.74it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.99it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  6.81it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.77it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.82it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.68it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.76it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  9.01it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.83it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.76it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  6.81it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.71it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.76it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  9.02it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.82it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.76it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.72it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  6.81it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.77it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  9.03it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.83it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.76it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.73it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.68it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.03it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.78it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:02<00:02,  6.65it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.84it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.35it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.73it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.72it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.03it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.78it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.85it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.50it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:02<00:02,  6.58it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.74it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.75it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.04it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.79it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.94it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.76it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:02,  6.71it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.77it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.04it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:51,  1.83s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.98it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.75it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.77it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.04it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  6.80it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.94it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.74it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.81it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.04it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.80it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.92it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  6.86it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.75it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.80it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.83it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.05it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.89it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.76it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  6.90it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.84it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.05it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.75it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.87it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.75it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.80it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.85it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.05it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  6.93it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.74it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.86it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.79it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.84it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.05it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.74it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:03<00:01,  6.95it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.85it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.56it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.81it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.05it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.85it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.76it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.85it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:03<00:01,  6.97it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.62it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.81it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.05it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.95it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.86it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.78it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.68it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.85it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.79it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.70it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.67it/s]
Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:01,  6.98it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.84it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.75it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.88it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.69it/s]
Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  6.99it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  6.93it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  6.94it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  6.97it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:04<00:00,  7.00it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:05<00:48,  1.79s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:04<00:00,  7.01it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  7.03it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:04<00:00,  6.83it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  13%|█▎        | 4/30 [00:07<00:46,  1.81s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:08<00:43,  1.75s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  20%|██        | 6/30 [00:10<00:42,  1.77s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:12<00:39,  1.73s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:14<00:37,  1.72s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:15<00:35,  1.71s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:17<00:33,  1.67s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:18<00:31,  1.65s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:20<00:29,  1.64s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:22<00:28,  1.66s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:23<00:26,  1.68s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:25<00:25,  1.67s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:27<00:23,  1.67s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:28<00:21,  1.65s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:30<00:19,  1.66s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:32<00:18,  1.67s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:33<00:16,  1.64s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:35<00:14,  1.63s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:37<00:12,  1.61s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:38<00:11,  1.64s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:40<00:09,  1.65s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:42<00:09,  1.91s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:45<00:08,  2.19s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:48<00:07,  2.35s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:51<00:05,  2.51s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:54<00:02,  2.61s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:55<00:00,  2.23s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:55<00:00,  1.85s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank7]:W1216 09:56:04.987000 3294459 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1216 09:56:04.989000 3294454 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank1]:W1216 09:56:04.989000 3294453 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank5]:W1216 09:56:04.989000 3294457 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank3]:W1216 09:56:04.989000 3294455 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank6]:W1216 09:56:04.990000 3294458 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1216 09:56:04.994000 3294456 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1216 09:56:05.352000 3294452 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.23130741715431213 sync: True time: 5.957443714141846 alloc_mem: 35819287552 peak_mem: 48181507072
Epoch 1, Step 20, Loss: 0.14958803355693817 sync: True time: 5.9536778926849365 alloc_mem: 35819287552 peak_mem: 48181507072
Epoch 1, Step 30, Loss: 0.1150679662823677 sync: True time: 5.96164608001709 alloc_mem: 35819287552 peak_mem: 48181507072
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=1 seq=1024 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 5.7467 alloc_mem: 35819287552 peak_mem: 48181507072
[rank0]:[W1216 09:59:40.296106617 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
