HOST_IP: 10.8.32.150
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 2 --seq_length 1024 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:1 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Running on device: cuda:4 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.32it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.19it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.74it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.24it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.66it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.34it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.51it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.52it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.14it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.35it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.74it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.26it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.46it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.69it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.50it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.83it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.54it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.08it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.61it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.68it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.77it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.68it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.01it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.84it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.80it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.36it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.58it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.92it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.78it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.10it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.91it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.87it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.50it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.48it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.00it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.83it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.16it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.97it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  7.97it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.56it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  7.60it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.06it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.86it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  9.01it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.20it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.08it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.61it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:03,  7.64it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.09it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.89it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  9.04it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.22it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.16it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.64it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  7.67it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  8.11it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.91it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  9.06it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.23it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  8.20it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.66it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.92it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.13it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  7.68it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  9.07it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.25it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.68it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.24it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.77it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.13it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  9.09it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  7.71it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.25it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.70it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.26it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.75it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:01,  9.09it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.14it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  7.72it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.26it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.71it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.27it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.81it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.09it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.13it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  7.73it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.71it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.26it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.28it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.85it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  9.10it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.14it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  7.76it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.72it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.27it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.29it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.88it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  9.10it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.14it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  7.83it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.73it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.15it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.91it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.30it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.87it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  7.91it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.74it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:02,  7.67it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.91it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.94it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.04it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.30it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:02<00:58,  2.01s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:01,  8.00it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.74it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.99it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  7.74it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.14it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.30it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.76it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.08it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.93it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  9.02it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:02<00:01,  7.78it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.21it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.30it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.76it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.15it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.95it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  9.03it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.26it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.29it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  7.80it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.77it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.96it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.19it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.03it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.30it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.29it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  7.82it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.78it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.96it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.05it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.22it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.33it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.30it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  7.81it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.98it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.06it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.25it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.35it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.27it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  7.70it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.80it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.97it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.08it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.26it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.36it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:01,  7.90it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.79it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.09it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.97it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  7.63it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.28it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.37it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.09it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.79it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.96it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  7.92it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:01,  7.56it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.29it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.38it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.09it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.95it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.78it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.04it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.30it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:03<00:00,  7.50it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.38it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.09it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.95it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.77it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.13it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.31it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:03<00:00,  7.52it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.39it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.09it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.95it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.80it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.69it/s]
Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.18it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  7.61it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.12it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.00it/s]
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.41it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.00it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.86it/s]
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.24it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.37it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  7.68it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.44it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.28it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.38it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.46it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.24it/s]
Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  7.79it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.30it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:51,  1.84s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.41it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.15it/s]
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  7.85it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.17it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  7.84it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  7.87it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  7.68it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  10%|█         | 3/30 [00:05<00:48,  1.81s/it]Loading checkpoint shards:  13%|█▎        | 4/30 [00:07<00:47,  1.82s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:09<00:44,  1.77s/it]Loading checkpoint shards:  20%|██        | 6/30 [00:10<00:42,  1.77s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:12<00:39,  1.73s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:14<00:38,  1.73s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:15<00:36,  1.72s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:17<00:33,  1.69s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:19<00:31,  1.66s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:20<00:29,  1.62s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:22<00:28,  1.67s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:24<00:27,  1.70s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:25<00:25,  1.69s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:27<00:23,  1.69s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:29<00:21,  1.66s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:30<00:20,  1.68s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:32<00:18,  1.69s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:34<00:16,  1.66s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:35<00:14,  1.64s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:37<00:13,  1.69s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:41<00:16,  2.41s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:43<00:12,  2.16s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:44<00:10,  2.04s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:47<00:08,  2.24s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:50<00:07,  2.38s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:53<00:05,  2.53s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:56<00:02,  2.61s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:57<00:00,  2.27s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:57<00:00,  1.92s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank1]:W1216 13:32:23.005000 3358260 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank5]:W1216 13:32:23.006000 3358264 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1216 13:32:23.007000 3358263 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1216 13:32:23.007000 3358261 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank7]:W1216 13:32:23.008000 3358266 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank6]:W1216 13:32:23.009000 3358265 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank3]:W1216 13:32:23.012000 3358262 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1216 13:32:23.233000 3358259 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.14839346706867218 sync: True time: 8.501785039901733 alloc_mem: 36344640512 peak_mem: 48723637248
Epoch 1, Step 20, Loss: 0.10003813356161118 sync: True time: 8.506174802780151 alloc_mem: 36344640512 peak_mem: 48723637248
Epoch 1, Step 30, Loss: 0.1258031129837036 sync: True time: 8.519045114517212 alloc_mem: 36344640512 peak_mem: 48723637248
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=2 seq=1024 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 8.2619 alloc_mem: 36344640512 peak_mem: 48723637248
[rank0]:[W1216 13:37:12.990930867 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
