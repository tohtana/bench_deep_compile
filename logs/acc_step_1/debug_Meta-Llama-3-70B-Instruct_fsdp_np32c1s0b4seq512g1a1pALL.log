HOST_IP: 10.8.32.99
NUM_NODES: 4
NUM_PROCESSES: 32
BACKEND: fsdp
ZERO_STAGE: 3
MODEL: meta-llama/Meta-Llama-3-70B-Instruct
EXTRA_OPTS: --batch_size 4 --seq_length 512 --activation_checkpointing --profile --profile_dir /mnt/post-training-ppo/projects/z3n/prof_osdi2025_repro --compile
Running on device: cuda:0 is_deepspeed: False
Loading model and tokenizer...
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Running on device: cuda:6 is_deepspeed: False
Running on device: cuda:1 is_deepspeed: False
Running on device: cuda:7 is_deepspeed: False
Running on device: cuda:5 is_deepspeed: False
Running on device: cuda:2 is_deepspeed: False
Running on device: cuda:3 is_deepspeed: False
Running on device: cuda:4 is_deepspeed: False
Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:03,  7.41it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.12it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.31it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.22it/s]Loading checkpoint shards:   0%|          | 0/30 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.05it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  7.11it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.85it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.99it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.63it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  8.08it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.88it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.95it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:00<00:04,  6.77it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.64it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.31it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.79it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.41it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.19it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  8.26it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:00<00:03,  7.53it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.96it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.97it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.48it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:02,  8.69it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.35it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.42it/s]Loading checkpoint shards:  10%|█         | 3/30 [00:00<00:03,  7.81it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  9.09it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  8.05it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.57it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.83it/s]Loading checkpoint shards:   3%|▎         | 1/30 [00:01<00:52,  1.83s/it]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.43it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:02,  8.51it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  9.13it/s]Loading checkpoint shards:  13%|█▎        | 4/30 [00:00<00:03,  7.98it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.13it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.63it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.88it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.48it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.55it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  9.10it/s]Loading checkpoint shards:  17%|█▋        | 5/30 [00:00<00:03,  8.06it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.67it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.19it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.89it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.52it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.59it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  9.09it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.69it/s]Loading checkpoint shards:  20%|██        | 6/30 [00:00<00:02,  8.11it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.90it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.23it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.49it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.60it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  9.08it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.70it/s]Loading checkpoint shards:  23%|██▎       | 7/30 [00:00<00:02,  8.14it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.67it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:00<00:02,  8.26it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.62it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.35it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  9.07it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.56it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.75it/s]Loading checkpoint shards:  27%|██▋       | 8/30 [00:01<00:02,  8.16it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.28it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:01,  9.07it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.64it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.43it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.80it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.55it/s]Loading checkpoint shards:  30%|███       | 9/30 [00:01<00:02,  8.19it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.29it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  9.06it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.48it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.43it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.85it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.61it/s]Loading checkpoint shards:  33%|███▎      | 10/30 [00:01<00:02,  8.20it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.30it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  9.06it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.52it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.47it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.87it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.66it/s]Loading checkpoint shards:  37%|███▋      | 11/30 [00:01<00:02,  8.22it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.31it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  9.06it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.55it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:01,  8.53it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.89it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.69it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.31it/s]Loading checkpoint shards:  40%|████      | 12/30 [00:01<00:02,  8.23it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.93it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.57it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.90it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.71it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.32it/s]Loading checkpoint shards:  43%|████▎     | 13/30 [00:01<00:02,  8.23it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.88it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.58it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.61it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.90it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.72it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.32it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.91it/s]Loading checkpoint shards:  47%|████▋     | 14/30 [00:01<00:01,  8.03it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.59it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.63it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.90it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.73it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.94it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.32it/s]Loading checkpoint shards:  50%|█████     | 15/30 [00:01<00:01,  8.10it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.59it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:01<00:01,  8.65it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.74it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.97it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.32it/s]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:01<00:01,  8.16it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.60it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.66it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.92it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.75it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.01it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.33it/s]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:02<00:01,  8.20it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.61it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.97it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.67it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.76it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.12it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.35it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:00,  9.02it/s]Loading checkpoint shards:  60%|██████    | 18/30 [00:02<00:01,  8.22it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.61it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.68it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.71it/s]Loading checkpoint shards:   7%|▋         | 2/30 [00:03<00:50,  1.81s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  9.17it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.35it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  9.01it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.68it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.61it/s]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:02<00:01,  8.24it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.70it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  9.13it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.99it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.34it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.68it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.60it/s]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:02<00:01,  8.26it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.72it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  9.10it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.98it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.68it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.60it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.08it/s]Loading checkpoint shards:  70%|███████   | 21/30 [00:02<00:01,  8.28it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.73it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  9.09it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.97it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.68it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.60it/s]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:02<00:00,  8.29it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.01it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.74it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  9.08it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:02<00:00,  8.96it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.68it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:02<00:00,  8.60it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.74it/s]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:02<00:00,  8.28it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.10it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  9.07it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.96it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.68it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.60it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  9.06it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.17it/s]Loading checkpoint shards:  80%|████████  | 24/30 [00:02<00:00,  8.28it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.96it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.68it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.09it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.00it/s]
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.75it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.22it/s]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:03<00:00,  8.30it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.97it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.67it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.74it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.25it/s]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:03<00:00,  8.30it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  9.02it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.86it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.62it/s]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.77it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.65it/s]
Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.28it/s]Loading checkpoint shards:  90%|█████████ | 27/30 [00:03<00:00,  8.29it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.61it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.57it/s]
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.63it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.52it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.31it/s]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:03<00:00,  8.30it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.34it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.22it/s]
Loading checkpoint shards:  97%|█████████▋| 29/30 [00:03<00:00,  8.31it/s]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.33it/s]Loading checkpoint shards: 100%|██████████| 30/30 [00:03<00:00,  8.18it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  10%|█         | 3/30 [00:05<00:49,  1.84s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  13%|█▎        | 4/30 [00:07<00:47,  1.84s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  17%|█▋        | 5/30 [00:09<00:45,  1.81s/it]Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards:  20%|██        | 6/30 [00:10<00:43,  1.80s/it]Loading checkpoint shards:  23%|██▎       | 7/30 [00:12<00:40,  1.77s/it]Loading checkpoint shards:  27%|██▋       | 8/30 [00:14<00:39,  1.78s/it]Loading checkpoint shards:  30%|███       | 9/30 [00:16<00:37,  1.77s/it]Loading checkpoint shards:  33%|███▎      | 10/30 [00:17<00:34,  1.75s/it]Loading checkpoint shards:  37%|███▋      | 11/30 [00:19<00:32,  1.72s/it]Loading checkpoint shards:  40%|████      | 12/30 [00:21<00:30,  1.71s/it]Loading checkpoint shards:  43%|████▎     | 13/30 [00:22<00:29,  1.73s/it]Loading checkpoint shards:  47%|████▋     | 14/30 [00:24<00:27,  1.75s/it]Loading checkpoint shards:  50%|█████     | 15/30 [00:26<00:25,  1.73s/it]Loading checkpoint shards:  53%|█████▎    | 16/30 [00:28<00:23,  1.71s/it]Loading checkpoint shards:  57%|█████▋    | 17/30 [00:29<00:22,  1.71s/it]Loading checkpoint shards:  60%|██████    | 18/30 [00:31<00:20,  1.73s/it]Loading checkpoint shards:  63%|██████▎   | 19/30 [00:33<00:19,  1.74s/it]Loading checkpoint shards:  67%|██████▋   | 20/30 [00:35<00:17,  1.72s/it]Loading checkpoint shards:  70%|███████   | 21/30 [00:36<00:15,  1.70s/it]Loading checkpoint shards:  73%|███████▎  | 22/30 [00:38<00:13,  1.69s/it]Loading checkpoint shards:  77%|███████▋  | 23/30 [00:40<00:11,  1.71s/it]Loading checkpoint shards:  80%|████████  | 24/30 [00:41<00:10,  1.73s/it]Loading checkpoint shards:  83%|████████▎ | 25/30 [00:43<00:08,  1.71s/it]Loading checkpoint shards:  87%|████████▋ | 26/30 [00:45<00:06,  1.69s/it]Loading checkpoint shards:  90%|█████████ | 27/30 [00:46<00:05,  1.68s/it]Loading checkpoint shards:  93%|█████████▎| 28/30 [00:48<00:03,  1.71s/it]Loading checkpoint shards:  97%|█████████▋| 29/30 [00:50<00:01,  1.72s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:51<00:00,  1.44s/it]Loading checkpoint shards: 100%|██████████| 30/30 [00:51<00:00,  1.71s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading dataset...
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
NCCL version 2.21.5+cuda12.4
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>

Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
Model prepared: <class 'torch.distributed.fsdp.fully_sharded_data_parallel.FullyShardedDataParallel'>
[rank6]:W1217 03:10:54.940000 79619 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank7]:W1217 03:10:54.940000 79620 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank5]:W1217 03:10:54.940000 79618 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank3]:W1217 03:10:54.940000 79616 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank2]:W1217 03:10:54.940000 79615 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank4]:W1217 03:10:54.941000 79617 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank1]:W1217 03:10:54.941000 79614 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
[rank0]:W1217 03:10:55.039000 79613 torch/_logging/_internal.py:1081] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
Epoch 1, Step 10, Loss: 0.39290285110473633 sync: True time: 8.320650577545166 alloc_mem: 36344640512 peak_mem: 48723637248
Epoch 1, Step 20, Loss: 0.24965409934520721 sync: True time: 8.329980611801147 alloc_mem: 36344640512 peak_mem: 48723637248
Epoch 1, Step 30, Loss: 0.2454293966293335 sync: True time: 8.338071346282959 alloc_mem: 36344640512 peak_mem: 48723637248
meta-llama/Meta-Llama-3-70B-Instruct ds=False np=32 batch_size=4 seq=512 zero_stage=3 acc=1 ac=True compile=True schedule=False passes=None compile_time=0 iteration time: 8.1058 alloc_mem: 36344640512 peak_mem: 48723637248
[rank0]:[W1217 03:15:42.468601571 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
